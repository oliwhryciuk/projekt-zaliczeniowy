{% extends "base.html" %}
{% load static %}

{% block title %}Bagz - Main Page{% endblock %}

{% block content %}
<style>
    .main-panes { 
        display: flex; 
        justify-content: center; 
        gap: 30px; 
        margin: 0 0 50px 0;
        flex-wrap: wrap;
    }
    .pane { 
        border-radius: 12px; 
        box-shadow: 0 2px 8px #0001; 
        text-align: center; 
        transition: all 0.2s; 
        cursor: pointer; 
        text-decoration: none; 
        color: #fff;
        width: 280px;
        height: 280px;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .pane-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: 1;
    }
    .pane-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.3);
        transition: background 0.2s;
        z-index: 2;
    }
    .pane-text {
        position: relative;
        z-index: 3;
        font-size: 2.2em;
        font-weight: bold;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
        letter-spacing: 1px;
    }
    .pane:hover .pane-overlay {
        background: rgba(0, 0, 0, 0.5);
    }
    .pane:hover {
        box-shadow: 0 6px 16px #0002;
        transform: translateY(-2px);
    }
    .bags-list { 
        max-width: 1000px; 
        margin: 0 auto; 
        background: #fff; 
        border-radius: 12px; 
        box-shadow: 0 2px 8px #0001; 
        padding: 40px;
    }
    .bags-list h2 { 
        margin: 0 0 30px 0; 
        font-size: 1.8em;
        color: #222;
    }
    .bag-item { 
        display: flex; 
        align-items: center; 
        gap: 20px; 
        border-bottom: 1px solid #eee; 
        padding: 20px 0; 
        transition: background 0.2s;
    }
    .bag-item:hover {
        background: #f9f9f9;
    }
    .bag-item:last-child { 
        border-bottom: none; 
    }
    .bag-photo { 
        width: 100px; 
        height: 100px; 
        object-fit: cover; 
        border-radius: 8px; 
        background: #eee;
        flex-shrink: 0;
        margin-left: 10px;
        border: 1px solid #ddd;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
    }
    .bag-info { 
        flex: 1; 
        min-width: 0;
    }
    .bag-title { 
        font-size: 1.1em; 
        font-weight: bold;
        margin-bottom: 5px;
    }
    .bag-title a { 
        color: #222; 
        text-decoration: none; 
    }
    .bag-title a:hover { 
        text-decoration: underline; 
    }
    .bag-meta { 
        color: #666; 
        font-size: 0.95em; 
    }
</style>
<div class="main-panes">
    <a class="pane" href="{% url 'store:small-bags' %}">
        <img class="pane-image" src="{% static 'images/mini_bags.jpg' %}" alt="Mini Bags">
        <div class="pane-overlay"></div>
        <div class="pane-text">MINI</div>
    </a>
    <a class="pane" href="{% url 'store:medium-bags' %}">
        <img class="pane-image" src="{% static 'images/midi_bags.jpg' %}" alt="Midi Bags">
        <div class="pane-overlay"></div>
        <div class="pane-text">MIDI</div>
    </a>
    <a class="pane" href="{% url 'store:big-bags' %}">
        <img class="pane-image" src="{% static 'images/maxi_bags.jpg' %}" alt="Maxi Bags">
        <div class="pane-overlay"></div>
        <div class="pane-text">MAXI</div>
    </a>
</div>
<div class="bags-list">
    <h2>Shop everything</h2>
    <div id="bags-list"></div>
</div>
<script>
    async function fetchBags() {
        const resp = await fetch('/api/bags/');
        const bags = await resp.json();
        const list = document.getElementById('bags-list');
        list.innerHTML = '';
        bags.forEach(bag => {
            const div = document.createElement('div');
            div.className = 'bag-item';
            let photoPath = '';
            if (bag.photo) {
                if (bag.photo.startsWith('/media/')) {
                    photoPath = bag.photo;
                } else if (bag.photo.startsWith('media/')) {
                    photoPath = '/' + bag.photo;
                } else {
                    photoPath = '/media/' + bag.photo;
                }
            }
            div.innerHTML = `
                <img class="bag-photo" src="${photoPath}" alt="Bag photo" onerror="this.style.display='none'">
                <div class="bag-info">
                    <div class="bag-title"><a href="/bags/${bag.id}/">${bag.brand} ${bag.model_name}</a></div>
                    <div class="bag-meta">Price: ${bag.price} z≈Ç</div>
                </div>
            `;
            list.appendChild(div);
        });
    }
    window.onload = fetchBags;
</script>
{% endblock %}
